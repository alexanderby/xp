var xp;!function(a){var b;!function(a){function b(a,b){var d=document.createElement("div");d.innerHTML=a;var e=d.firstElementChild;for(var f in b){var g=c(f,e);if(!g)throw new Error('Selector "'+f+"\" didn't return anything.");var h=b[f];h(g)}return e}function c(a,b){return b=b||document,b.querySelector(a)}function d(a){return a.parentNode?a.parentNode.removeChild(a):a}a.create=b,a.select=c,a.remove=d}(b=a.Dom||(a.Dom={}))}(xp||(xp={}));var xp;!function(a){var b;!function(b){function c(c,d,e){for(var f=[],g=3;g<arguments.length;g++)f[g-3]=arguments[g];if((d&b.DisplayMessages)>0&&(c&b.DisplayMessages)>0){var h;if("string"==typeof e){f.unshift(e);var h=a.formatString.apply(null,f)}else h=e;switch(c){case 1:console.log(h);break;case 2:console.info(h);break;case 4:console.warn(h);break;case 8:console.error(h);break;default:throw new Error("Not implemented.")}}}!function(a){a[a.Log=1]="Log",a[a.Info=2]="Info",a[a.Warn=4]="Warn",a[a.Error=8]="Error"}(b.HeatLevel||(b.HeatLevel={}));b.HeatLevel;!function(a){a[a.Misc=16]="Misc",a[a.Binding=32]="Binding",a[a.UI=64]="UI",a[a.Test=128]="Test"}(b.Domain||(b.Domain={}));b.Domain;b.DisplayMessages=254,b.write=c,window.console||(window.console={}),window.console.log||(window.console.log=function(){}),window.console.info||(window.console.info=function(){}),window.console.warn||(window.console.warn=function(){}),window.console.error||(window.console.error=function(){})}(b=a.Log||(a.Log={}))}(xp||(xp={}));var xp;!function(a){function b(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];for(var d=a,e=0;e<b.length;e++)d=d.replace(new RegExp("\\{"+e+"\\}","gm"),b[e]);return d}function c(b){var c=[],d=[],e=function(b){var f=c.indexOf(b);if(f>=0)return d[f];var g=typeof b;if(null===b||"string"===g||"boolean"===g||"number"===g||"undefined"===g||"function"===g)return b;if(b instanceof Object){var h;if(b instanceof Date){var i=new Date;i.setDate(b.getTime()),h=i}else if(b instanceof Array){for(var j=[],k=0;k<b.length;k++)j[k]=e(b[k]);h=j}else if(b instanceof a.ObservableCollection){for(var l=new a.ObservableCollection,k=0;k<b.length;k++)l.push(e(b[k]));h=l}else if(b instanceof a.ObservableObject){var m={};for(var n in b)m[n]=e(b[n]);h=a.observable(m)}else if(b instanceof Node)h=b.cloneNode(!0);else{var o=Object.getPrototypeOf(b).constructor,p=new o;for(var n in b)b.hasOwnProperty(n)&&(p[n]=e(b[n]));h=p}return c.push(b),d.push(h),h}throw new Error("Item type is not supported for cloning.")};return e(b)}function d(){for(var a=[],b="0123456789abcdef",c=0;36>c;c++)a[c]=b.substr(Math.floor(16*Math.random()),1);a[14]="4",a[19]=b.substr(3&a[19]|8,1),a[8]=a[13]=a[18]=a[23]="-";var d=a.join("");return d}function e(a){var b=/function\s+(.+?)\s*\(/,c=b.exec(a.constructor.toString());return c&&c.length>1?c[1]:""}function f(a,b){return new(a.bind.apply(a,[null].concat(b)))}function g(a,b){var c=a.prototype;for(var d in c)if(!b||0===b.length||b.indexOf(d)>=0){var e=Object.getOwnPropertyDescriptor(c,d);e&&e.configurable&&(e.enumerable=!1,Object.defineProperty(c,d,e))}}a.formatString=b,a.clone=c,a.createUuid=d,a.getClassName=e,a.applyConstructor=f,a.hidePrototypeProperties=g}(xp||(xp={}));var xp;!function(a){var b;!function(b){function c(a,b,c){if(void 0===c&&(c=!0),!a){if(c)throw new Error('Unable to get property by path "'+b+'".');return void 0}if(b=b.replace(/\[(.+)\]/g,".$1"),""===b)return a;var d=b.split("."),e=a;return d.every(function(a){if(void 0===e||null===e){if(c)throw new Error('Unable to get property by path "'+b+'".');return!1}return e=e[a],!0}),e}function d(b,d,g,h){void 0===h&&(h=!0);var i=e(d),b=c(b,i,h),j=f(d);if(!(j in b)&&h)throw new Error(a.formatString('Unable to set property value "{0}" by path "{1}". Property is unreachable.',g,d));b[j]=g}function e(a){a=a.replace(/\[(.+)\]/g,".$1");var b=a.match(/^(.*)\.[^\.]*$/);return b&&b[1]?b[1]:""}function f(a){a=a.replace(/\[(.+)\]/g,".$1");var b=a.match(/(^.*\.)?([^\.]*)$/);return b&&b[2]?b[2]:""}function g(b){var c=b.replace(h,function(c,d){if(!i.test(d))throw new Error(a.formatString('Wrong property identifier. Property: "{0}". Path: "{1}".',b,d));return"."+d});return c}b.getPropertyByPath=c,b.setPropertyByPath=d,b.getObjectPath=e,b.getPropertyName=f,b.replaceIndexers=g;var h=/\[(.+?)\]/g,i=/^[0-9A-Z_$]*$/i}(b=a.Path||(a.Path={}))}(xp||(xp={}));var xp;!function(a){var b=function(){function a(a){this.pairs=a||[]}return a.prototype.get=function(a){var b=this.pairs.filter(function(b){return b.key===a});return b.length>0?b[0].value:void 0},a.prototype.set=function(a,b){var c=this.pairs.filter(function(b){return b.key===a});c.length>0?void 0===b?this.pairs.splice(this.pairs.indexOf(c[0]),1):c[0].value=b:this.pairs.push({key:a,value:b})},a.prototype.remove=function(a){var b=this.pairs.filter(function(b){return b.key===a});b.length>0&&this.pairs.splice(this.pairs.indexOf(b[0]),1)},a}();a.Dictionary=b}(xp||(xp={}));var xp;!function(a){var b=function(){function a(){this.handlers=[]}return a.prototype.addHandler=function(a,b){var c={event:this,handler:a,scope:b};if(this.handlers.filter(function(b){return b.handler===a})[0])throw new Error("Duplicate subscription.");return this.handlers.push(c),c},a.prototype.removeHandler=function(a){var b=this.handlers.filter(function(b){return b.handler===a})[0];if(!b)throw new Error("Unable to remove event handler :\n"+a.toString());return this.handlers.splice(this.handlers.indexOf(b),1),b.handler},a.prototype.removeAllHandlers=function(){this.handlers=[]},a.prototype.hasHandler=function(a){return this.handlers.filter(function(b){return b.handler===a}).length>0},a.prototype.invoke=function(a){this.handlers.forEach(function(b){b.handler.call(b.scope,a)})},a}();a.Event=b;var c=function(){function a(){this.subscriptions=[]}return a.prototype.subscribe=function(a,b,c){var d=a.addHandler(b,c);return this.subscriptions.push(d),d},a.prototype.unsubscribe=function(a){for(var b;(b=this.subscriptions.indexOf(this.subscriptions.filter(a)[0]))>=0;){var c=this.subscriptions[b];c.event.removeHandler(c.handler),this.subscriptions.splice(b,1)}},a.prototype.unsubscribeAll=function(){this.subscriptions.forEach(function(a){a.event.removeHandler(a.handler)}),this.subscriptions=[]},a}();a.EventRegistrar=c}(xp||(xp={}));var xp;!function(a){function b(a){return a&&"object"==typeof a&&"onPropertyChanged"in a}a.isNotifier=b;var ObservableObject=function(){function ObservableObject(a,b){void 0===b&&(b=!0),this.__initProperties__(),this.__convertNested__=b,a&&this.__copySource__(a)}return ObservableObject.prototype.__initProperties__=function(){Object.defineProperty(this,"onPropertyChanged",{configurable:!0,value:new a.Event}),Object.defineProperty(this,"__convertNested__",{configurable:!0,writable:!0,value:!0})},ObservableObject.prototype.__copySource__=function(a){if(a instanceof ObservableObject)throw new Error("Source object is already observable.");if(Array.isArray(a))throw new Error("Source must not be an array. Use ObservableCollection.");if(!(a instanceof Object))throw new Error("Source must be an object.");for(var b in a)ObservableObject.extend(this,b,a[b],this.__convertNested__)},ObservableObject.isConvertable=function(a){return!("object"!=typeof a||b(a)||null===a||a instanceof Date)},ObservableObject.extend=function(b,c,d,e){if(void 0===e&&(e=!0),c in b)throw new Error('Unable to create notification property. Object already has "'+c+'" property.');if("onPropertyChanged"===c)throw new Error('Unable to create notification property. Reserved name "'+c+'" is used.');if(d instanceof Date){var f=new Date;f.setTime(d.getTime()),d=f}var g=function(){return d};if(e&&ObservableObject.isConvertable(d)){d=a.observable(d);var h=function(e){ObservableObject.isConvertable(e)&&(e=a.observable(e)),d=e,b.onPropertyChanged.invoke(c)}}else var h=function(a){d=a,b.onPropertyChanged.invoke(c)};Object.defineProperty(b,c,{get:g,set:h,enumerable:!0,configurable:!0})},ObservableObject}();a.ObservableObject=ObservableObject,a.hidePrototypeProperties(ObservableObject)}(xp||(xp={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};Object.defineProperties(Array.prototype,{move:{value:function(a,b){if(0>a&&(a=this.length+a),0>b&&(b=this.length+b),a>this.length-1||b>this.length-1||0>a||0>b)throw new Error("Index was out of range.");var c=this.splice(a,1)[0];return this.splice(b,0,c),this}},attach:{value:function(a,b){return this.splice(b,0,a),this.length}},detach:{value:function(a){return this.splice(a,1)[0]}}});var xp;!function(a){function b(a){return a&&"object"==typeof a&&"onCollectionChanged"in a}!function(a){a[a.Create=0]="Create",a[a.Replace=1]="Replace",a[a.Delete=2]="Delete",a[a.Move=3]="Move",a[a.Attach=4]="Attach",a[a.Detach=5]="Detach"}(a.CollectionChangeAction||(a.CollectionChangeAction={}));a.CollectionChangeAction;a.isCollectionNotifier=b;var ObservableCollection=function(b){function ObservableCollection(a,c){void 0===c&&(c=!0),b.call(this,a,c)}return __extends(ObservableCollection,b),ObservableCollection.prototype.__initProperties__=function(){var c=this;b.prototype.__initProperties__.call(this);var d=function(a,b,d){Object.defineProperty(c,a,{configurable:!0,enumerable:!1,writable:!!d,value:b})};d("onCollectionChanged",new a.Event),d("inner",[],!0),d("sorting",!1,!0),d("splicing",!1,!0)},ObservableCollection.prototype.__copySource__=function(a){var b=this;if(a&&(!Array.isArray(a)||a instanceof ObservableCollection))throw new Error("Source must be an array.");a&&a.forEach(function(a,c){b.add(a,c)})},ObservableCollection.prototype.add=function(a,b,c){if(a=this.createNotifierIfPossible(a),this.inner.splice(b,0,a),this.appendIndexProperty(),this.onCollectionChanged.invoke({action:c?4:0,newIndex:b,newItem:a}),this.onPropertyChanged.invoke("length"),!this.__splicing__)for(var d=b;d<this.inner.length;d++)this.onPropertyChanged.invoke(d.toString())},ObservableCollection.prototype.remove=function(a,b){var c=this.inner.splice(a,1)[0];if(this.deleteIndexProperty(),this.onCollectionChanged.invoke({action:b?5:2,oldIndex:a,oldItem:c}),this.onPropertyChanged.invoke("length"),!this.__splicing__)for(var d=a;d<this.inner.length+1;d++)this.onPropertyChanged.invoke(d.toString());return c},ObservableCollection.prototype.appendIndexProperty=function(){var a=this,b=this.inner.length-1;Object.defineProperty(this,b.toString(),{get:function(){return a.inner[b]},set:function(c){c=a.createNotifierIfPossible(c),a.onCollectionChanged.invoke({action:1,oldIndex:b,newIndex:b,oldItem:a.inner[b],newItem:a.inner[b]=c}),a.onPropertyChanged.invoke(b.toString())},enumerable:!0,configurable:!0})},ObservableCollection.prototype.deleteIndexProperty=function(){delete this[this.inner.length]},ObservableCollection.prototype.createNotifierIfPossible=function(b){return this.__convertNested__&&a.ObservableObject.isConvertable(b)&&(b=a.observable(b)),b},Object.defineProperty(ObservableCollection.prototype,"length",{get:function(){return this.inner.length},enumerable:!0,configurable:!0}),ObservableCollection.prototype.move=function(a,b){if(this.inner.move(a,b),this.onCollectionChanged.invoke({action:3,oldIndex:a,newIndex:b,oldItem:this.inner[b],newItem:this.inner[b]}),!this.__sorting__)for(var c=Math.min(a,b);c<=Math.max(a,b);c++)this.onPropertyChanged.invoke(c.toString());return this.inner},ObservableCollection.prototype.attach=function(a,b){return this.add(a,b,!0),this.inner.length},ObservableCollection.prototype.detach=function(a){var b=this.remove(a,!0);return b},ObservableCollection.prototype.pop=function(){var a=this.remove(this.inner.length-1);return a},ObservableCollection.prototype.push=function(){for(var a=this,b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];return b.forEach(function(b){a.add(b,a.inner.length)}),this.inner.length},ObservableCollection.prototype.reverse=function(){this.__sorting__=!0;for(var a=this.inner.length,b=0;a-1>b;b++)this.move(0,a-1-b);this.__sorting__=!1;for(var b=0;a>b;b++)(a%2!==1||Math.floor(a/2)!==b)&&this.onPropertyChanged.invoke(b.toString());return this.inner},ObservableCollection.prototype.shift=function(){var a=this.remove(0);return a},ObservableCollection.prototype.sort=function(a){var b=this,c=this.inner.slice(),d=c.slice().sort(a),e=c.map(function(a,b){return{old:b,"new":d.indexOf(a)}});e.sort(function(a,b){return b["new"]-a["new"]});for(var f=0;f<e.length;f++)for(var g=f+1;g<e.length;g++)e[f].old<e[g].old&&e[g].old--;return this.__sorting__=!0,e.forEach(function(a){return a.old!==a["new"]&&b.move(a.old,a["new"])}),this.__sorting__=!1,e.forEach(function(a){a["new"]!==a.old&&b.onPropertyChanged.invoke(a["new"].toString())}),this.inner},ObservableCollection.prototype.splice=function(a,b){for(var c=this,d=[],e=2;e<arguments.length;e++)d[e-2]=arguments[e];if(void 0===a)throw new Error("The specified arguments may lead to unexpected result.");if(0>a&&(a=this.inner.length+a),0>a||a>this.inner.length||0>b)throw new Error("Index was out of range.");b=isNaN(b)?this.inner.length-a:b;var f=this.inner.length;this.__splicing__=!0;for(var g=new Array,h=0;b>h;h++){var i=this.remove(a);g.push(i)}if(d){var j=a;d.forEach(function(a){c.add(a,j),j++})}this.__splicing__=!1;for(var k=d?d.length:0,l=this.inner.length,m=b===k?a+k:Math.max(l,f),h=a;m>h;h++)this.onPropertyChanged.invoke(h.toString());return g},ObservableCollection.prototype.unshift=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return this.splice(0,0,a.length>1?a:a[0]),this.inner.length},ObservableCollection.prototype.concat=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return this.inner.concat.apply(this.inner,arguments)},ObservableCollection.prototype.join=function(a){return this.inner.join.apply(this.inner,arguments)},ObservableCollection.prototype.slice=function(a,b){return this.inner.slice.apply(this.inner,arguments)},ObservableCollection.prototype.toJSON=function(){return this.inner},ObservableCollection.prototype.toString=function(){return Object.prototype.toString.call(this)},ObservableCollection.prototype.toLocaleString=function(){return this.inner.toLocaleString()},ObservableCollection.prototype.indexOf=function(a,b){return this.inner.indexOf.apply(this.inner,arguments)},ObservableCollection.prototype.lastIndexOf=function(a,b){return this.inner.lastIndexOf.apply(this.inner,arguments)},ObservableCollection.prototype.forEach=function(a,b){return this.inner.forEach.apply(this.inner,arguments)},ObservableCollection.prototype.every=function(a,b){return this.inner.every.apply(this.inner,arguments)},ObservableCollection.prototype.some=function(a,b){return this.inner.some.apply(this.inner,arguments)},ObservableCollection.prototype.filter=function(a,b){return this.inner.filter.apply(this.inner,arguments)},ObservableCollection.prototype.map=function(a,b){return this.inner.map.apply(this.inner,arguments)},ObservableCollection.prototype.reduce=function(a,b){return this.inner.reduce.apply(this.inner,arguments)},ObservableCollection.prototype.reduceRight=function(a,b){return this.inner.reduceRight.apply(this.inner,arguments)},ObservableCollection}(a.ObservableObject);a.ObservableCollection=ObservableCollection,a.hidePrototypeProperties(ObservableCollection)}(xp||(xp={}));var xp;!function(a){function b(b,c){if(void 0===c&&(c=!0),a.isNotifier(b))throw new Error("Source object is already observable.");if("object"!=typeof b)throw new Error("Source must be an object.");if(b instanceof Date)throw new Error("Dates cannot be converted into an observable.");return Array.isArray(b)?new a.ObservableCollection(b,c):new a.ObservableObject(b,c)}a.observable=b}(xp||(xp={}));var xp;!function(a){function b(b,c){var d=function(a){for(var b;b!==a;)b=a,a=a.replace(/\([^\(\)]*\)/g,function(a){return new Array(a.length+1).join(" ")});return a},e=function(a){var b=a.replace(/((".*?")|('.*?'))/g,function(a,b){return new Array(b.length+1).join(" ")});b=d(b);var c=b.indexOf(this.op);return 0>c?null:[a.slice(0,c),a.slice(c+this.op.length,a.length)]},f=function(a){var b=a.replace(/((".*?")|('.*?'))/g,function(a,b){return new Array(b.length+1).join(" ")});b=d(b);var c=b.indexOf(this.op);return 0>c?null:[a.slice(c+this.op.length,a.length)]},g=[{op:"?:",fn:function(a,b,c){return a?b:c},split:function(a){var b=a.replace(/((".*?")|('.*?'))/g,function(a,b){return new Array(b.length+1).join(" ")});b=d(b);var c=b.indexOf(this.op[0]);if(0>c)return null;var e=b.indexOf(this.op[1],c+1);return 0>e?null:[a.slice(0,c),a.slice(c+1,e),a.slice(e+1,a.length)]}},{op:"||",fn:function(a,b){return a||b},split:e},{op:"&&",fn:function(a,b){return a&&b},split:e},{op:"!==",fn:function(a,b){return a!==b},split:e},{op:"===",fn:function(a,b){return a===b},split:e},{op:"!=",fn:function(a,b){return a!=b},split:e},{op:"==",fn:function(a,b){return a==b},split:e},{op:">=",fn:function(a,b){return a>=b},split:e},{op:">",fn:function(a,b){return a>b},split:e},{op:"<=",fn:function(a,b){return b>=a},split:e},{op:"<",fn:function(a,b){return b>a},split:e},{op:"-",fn:function(a,b){return a-b},split:e},{op:"+",fn:function(a,b){return a+b},split:e},{op:"/",fn:function(a,b){return a/b},split:e},{op:"*",fn:function(a,b){return a*b},split:e},{op:"typeof",fn:function(a){return typeof a},split:f},{op:"!",fn:function(a){return!a},split:f}],h=function(b,d){if(b=b.trim(),void 0===d&&(d=0),d===g.length){if("("===b[0]&&")"===b[b.length-1])return h(b.slice(1,b.length-1),0);if("true"===b)return!0;if("false"===b)return!1;var e=+b;if(""!==b&&!isNaN(e))return e;if(/^(".*")|('.*')$/.test(b))return b.slice(1,b.length-1);if(b in c)return c[b];if(b in window)return window[b];var f=b.indexOf(".");if(f>=0){var i=b.slice(0,f);if(!(i in c||i in window))throw new Error("Expression scope doesn't contain \""+i+'".');var j=i in c?c[i]:window[i],k=b.slice(f+1,b.length),l=a.Path.getObjectPath(k),m=a.Path.getPropertyByPath(j,l,!1);if("object"!=typeof m||null===m)return void a.Log.write(2,32,"Unable to execute expression: Item supposed to be an object.");var n=a.Path.getPropertyName(k),o=n.match(/\((.*)\)$/);if(o&&o[1]){n=n.slice(0,o.index);var p=o[1],q=p.split(",").map(function(a){return h(a)});return m[n].apply(m,q)}return m[n]}var o=b.match(/\((.*)\)$/);if(o&&o[1]){var n=b.slice(0,o.index),p=o[1],q=p.split(",").map(function(a){return h(a)});return m[n].apply(m,q)}throw new Error("Expression scope doesn't contain \""+b+'".')}var r=g[d],s=r.split(b);if(s){for(var t=[],u=0;u<s.length;u++){var v=h(s[u],d);t.push(v)}return r.fn.apply(null,t)}return h(b,d+1)},i=h(b);return i}var Expression=function(){function Expression(c,d){var e=this;this.sourceSetToken=!1,this.scope=d,Object.defineProperty(this,"onPropertyChanged",{value:new a.Event});var f=/\{([^\s\(\)]+?)\}/g,g=c.match(f),h=[];if(g)for(var i=0;i<g.length;i++){var j=g[i].replace("{","").replace("}","");if(""===j)throw new Error('Empty path binding for expression is not supported. Expression: "'+c+'"');h.indexOf(j)<0&&h.push(j)}this.propsPaths=h;var k=c,l=[];this.params={onPropertyChanged:new a.Event},this.collectionRegistrations={},h.forEach(function(b,c){var d="p"+c;k=k.split("{"+b+"}").join(d),l.push(d);var f="_"+d;e.params[f]=null,Object.defineProperty(e.params,d,{get:function(){return e.params[f]},set:function(b){if(e.collectionRegistrations[d]&&(e.collectionRegistrations[d].unsubscribeAll(),delete e.collectionRegistrations[d]),void 0!==b&&a.isCollectionNotifier(b)){var c=new a.EventRegistrar,g=b;c.subscribe(g.onCollectionChanged,function(a){e.exec()},e),e.collectionRegistrations[d]=c}e.params[f]=b,e.sourceSetToken||e.exec()},enumerable:!0,configurable:!0})}),this.func=function(){for(var a={},c=0;c<arguments.length;c++)a["p"+c]=arguments[c];var d=b(k,a);return d},this.managers=[],this.propsPaths.forEach(function(b,c){var d=new a.BindingManager(e.params,l[c],e.scope,b);e.managers.push(d)}),this.exec()}return Object.defineProperty(Expression.prototype,"result",{get:function(){return this.resultField},set:function(a){this.resultField=a,this.onPropertyChanged.invoke("result")},enumerable:!0,configurable:!0}),Expression.prototype.exec=function(){var b=[];for(var c in this.params)if("p"===c[0]){var d=this.params[c];d instanceof a.ObservableCollection&&(d=d.slice()),b.push(d)}try{this.resultField=this.func.apply(null,b)}catch(e){a.Log.write(4,32,"Expression error: "+e),this.resultField=null}this.onPropertyChanged.invoke("result")},Expression.prototype.resetWith=function(a){this.sourceSetToken=!0,this.scope=a,this.managers.forEach(function(b){b.resetWith(a)}),this.sourceSetToken=!1,this.exec()},Expression.prototype.unbind=function(){this.managers.forEach(function(a){return a.unbind()}),this.onPropertyChanged.removeAllHandlers()},Expression}();a.Expression=Expression,a.hidePrototypeProperties(Expression),a.evaluate=b}(xp||(xp={}));var xp;!function(a){var BindingManager=function(){function BindingManager(b,c,d,e,f){if(!c)throw new Error("Target property path is not set.");if(!e)throw new Error("Unable to bind to empty path.");if(this.target=b,this.targetPropertyPath=c,this.scope=d,this.path=e,this.defaultValue=f,this.pathParts=a.Path.replaceIndexers(e).split("."),!this.pathParts||this.pathParts.length<1)throw new Error(a.formatString('Wrong binding path: "{0}".',e));this.pathParts.forEach(function(b){if(""===b)throw new Error(a.formatString('Unable to bind to empty path. Path: "{0}".',e))}),this.registerPathObjects(),this.updateTarget()}return BindingManager.prototype.registerPathObjects=function(b){var c=this;if(void 0===b&&(b=0),this.pathObjects){for(var d=this.pathObjects,e=b;e<d.length-1;e++)a.isNotifier(d[e].obj)&&d[e].obj.onPropertyChanged.removeHandler(d[e].handler);this.pathObjects.splice(b,d.length-b)}var f=this.pathParts;0===b&&(this.pathObjects=[]),this.pathObjects[b]={obj:0===b?this.scope:a.Path.getPropertyByPath(this.scope,f.slice(0,b).join("."))};for(var d=this.pathObjects,e=b;e<f.length;e++){var g=f[e];d[e].prop=g;var h=d[e].obj;if(!h)break;if(d[e+1]={obj:h[g]},a.isNotifier(h)){var i;i=e==f.length-1?function(a){return function(b){b===a&&c.updateTarget()}}(g):function(a,b){return function(d){d===a&&(c.registerPathObjects(b),c.updateTarget())}}(g,e+1),d[e].obj.onPropertyChanged.addHandler(i,this),d[e].handler=i}}this.pathObjects=d},BindingManager.prototype.resetWith=function(b){this.logMessage(a.formatString('Reset with "{0}".',this.scope)),this.scope=b,this.registerPathObjects(),this.updateTarget()},BindingManager.prototype.updateSource=function(){var b=a.Path.getPropertyByPath(this.target,this.targetPropertyPath),c=this.pathParts.length,d=this.pathObjects[c-1].obj;if("object"==typeof d&&null!==d){this.logMessage(a.formatString('Update source "{0}" property with value "{1}".',this.path,b));var e=this.pathParts[c-1];d[e]=b}else this.logMessage(a.formatString('Unable to update source property "{0}". It is unreachable.',this.path))},BindingManager.prototype.updateTarget=function(){var b=a.Path.getPropertyByPath(this.scope,this.path,!1),c=a.Path.getObjectPath(this.targetPropertyPath),d=a.Path.getPropertyName(this.targetPropertyPath),e=a.Path.getPropertyByPath(this.target,c);void 0!==b&&null!==b?(this.logMessage(a.formatString('Update target with "{0}" property value "{1}".',this.path,b)),e[d]=b):(this.logMessage(a.formatString('Unable to reach value "{0}". Using default value "{1}".',this.path,this.defaultValue)),e[d]=this.defaultValue)},BindingManager.prototype.unbind=function(){if(this.logMessage("Unbind."),this.pathObjects)for(var b=this.pathObjects,c=0;c<b.length-1;c++)a.isNotifier(b[c].obj)&&b[c].obj.onPropertyChanged.removeHandler(b[c].handler)},BindingManager.prototype.logMessage=function(b){a.Log.write(1,32,'BM of "{0}#{1}.{2}": {3}',a.getClassName(this.target),this.target.name,this.targetPropertyPath,b)},BindingManager}();a.BindingManager=BindingManager}(xp||(xp={}));var xp;!function(a){var BindingCallManager=function(a){function BindingCallManager(b,c,d,e,f){a.call(this,function(){var a={};return Object.defineProperty(a,"result",{set:function(a){d(a)},get:function(){return e?e():void 0}}),a}(),"result",b,c,f)}return __extends(BindingCallManager,a),BindingCallManager}(a.BindingManager);a.BindingCallManager=BindingCallManager}(xp||(xp={}));var xp;!function(a){var Model=function(){function Model(){Object.defineProperty(this,"onPropertyChanged",{enumerable:!1,configurable:!0,writable:!1,value:new a.Event})}return Model.property=function(b,c,d,e){e=e||{};var f=a.isNotifier(d),g=d instanceof a.ObservableObject?d.__convertNested__:!1;if(void 0===e.enumerable&&(e.enumerable=!0),e.getterConvertor)var h=e.getterConvertor,i=function(){return h(d)};else var i=function(){return d};if(e.setterConvertor){var j=e.setterConvertor;if(f)var k=function(e){a.ObservableObject.isConvertable(e)&&(e=a.observable(e,g)),d=j(e),b.onPropertyChanged.invoke(c)};else var k=function(a){d=j(a),b.onPropertyChanged.invoke(c)}}else if(f)var k=function(e){a.ObservableObject.isConvertable(e)&&(e=a.observable(e,g)),d=e,b.onPropertyChanged.invoke(c)};else var k=function(a){d=a,b.onPropertyChanged.invoke(c)};Object.defineProperty(b,c,{get:i,set:k,configurable:!0,enumerable:e.enumerable})},Model.nonEnumerableField=function(a,b,c){Object.defineProperty(a,b,{enumerable:!1,configurable:!0,writable:!0,value:c})},Model}();a.Model=Model}(xp||(xp={}));var xp;!function(a){var Scope=function(){function Scope(b,c){var d=this;Object.defineProperty(this,"onPropertyChanged",{value:new a.Event}),Object.defineProperty(this,"__registrar__",{value:new a.EventRegistrar});var e=[],f=!1,g=function(a){Object.defineProperty(d,a,{enumerable:!0,configurable:!0,get:function(){return b[a]},set:function(c){f=!0,b[a]=c,f=!1,d.onPropertyChanged.invoke(a)}}),e.push(a)};for(var h in b)g(h);if(a.isNotifier(b)&&this.__registrar__.subscribe(b.onPropertyChanged,function(a){f||(e.indexOf(a)<0&&g(a),d.onPropertyChanged.invoke(a))},this),c){var i=[],j=function(a){Object.defineProperty(d,a,{enumerable:!0,configurable:!0,get:function(){return c[a]},set:function(b){f=!0,c[a]=b,f=!1,d.onPropertyChanged.invoke(a)}}),i.push(a)};for(var h in c)e.indexOf(h)<0&&j(h);a.isNotifier(c)&&this.__registrar__.subscribe(c.onPropertyChanged,function(a){!f&&e.indexOf(a)<0&&(i.indexOf(a)<0&&j(a),d.onPropertyChanged.invoke(a))},this)}}return Scope.prototype.unsubscribeScopeFromChanges=function(){this.__registrar__.unsubscribeAll()},Scope}();a.Scope=Scope,a.hidePrototypeProperties(Scope)}(xp||(xp={}));var xp;!function(a){function b(b,c,d,e){return void 0===c&&(c=!0),void 0===e&&(e=" "),JSON.stringify(b,function(b,e){return c&&null!==e&&"object"==typeof e&&!Array.isArray(e)&&Object.getPrototypeOf(e)!==Object&&(e.__xp_model__=a.getClassName(e)),d&&(e=d(b,e)),e},e)}function c(b,c,d){var e={};return c&&c.forEach(function(a){var b=a.toString().match(/^function\s*(.*?)\s*\(/)[1];if(b in e)throw new Error('Duplicate model name: "'+b+'".');e[b]=a}),JSON.parse(b,function(b,c){if(d&&(c=d(b,c)),"object"==typeof c&&null!==c&&"__xp_model__"in c){if("ObservableObject"===c.__xp_model__||"ObservableCollection"===c.__xp_model__)return delete c.__xp_model__,a.observable(c);var f=e[c.__xp_model__];if(!f)throw new Error('No costructor specified for model "'+c.__xp_model__+'".');var g=new f;for(var h in c)"__xp_model__"!==h&&(g[h]=c[h]);return g}return c})}a.serialize=b,a.deserialize=c}(xp||(xp={}));var xp;!function(a){function b(a,b){var c=a.domElement.getBoundingClientRect(),d={domEvent:b,element:a};return"pageX"in b&&(d.elementX=b.pageX-c.left),"pageY"in b&&(d.elementY=b.pageY-c.top),d}a.createEventArgs=b}(xp||(xp={}));var xp;!function(a){var Element=function(b){function Element(a){var c=this;b.call(this),this.__isRendered__=!1,this.parentScopeChangeHandler=function(){if(c.useParentScope){var a=c.bindings.get("scope");a?a.resetWith(c.parent.scope):c.scope=c.parent.scope}},this.useParentScope=!0,this.initElement(),a&&this.applyMarkup(a),this.init&&this.init(this)}return __extends(Element,b),Element.prototype.initElement=function(){this.defineProperties(),this.domElement=this.getTemplate(),this.initEvents(),this.setDefaults()},Element.prototype.getTemplate=function(){throw new Error("Unable to create an instance of an abstract element.")},Element.prototype.renderTo=function(a){a.parentElement.replaceChild(this.domElement,a),this.__setRenderedState__(!0)},Element.prototype.__setRenderedState__=function(a){this.__isRendered__=a,a&&this.onRendered&&this.onRendered.invoke(this)},Element.prototype.initEvents=function(){var b=this;this.bindings=new a.Dictionary,this.expressions=new a.Dictionary,this.onScopeChanged=new a.Event,this.onRendered=new a.Event,this.onClick=new a.Event,this.onDoubleClick=new a.Event,this.onMouseDown=new a.Event,this.onMouseUp=new a.Event,this.onMouseMove=new a.Event,this.onMouseEnter=new a.Event,this.onMouseLeave=new a.Event,this.onKeyPress=new a.Event,this.onKeyDown=new a.Event,this.onKeyUp=new a.Event,this.onRemoved=new a.Event,this.onRemoved.addHandler(function(){b.onScopeChanged.removeAllHandlers(),b.onRendered.removeAllHandlers(),b.onClick.removeAllHandlers(),b.onDoubleClick.removeAllHandlers(),b.onMouseDown.removeAllHandlers(),b.onMouseUp.removeAllHandlers(),b.onMouseMove.removeAllHandlers(),b.onMouseEnter.removeAllHandlers(),b.onMouseLeave.removeAllHandlers(),b.onKeyPress.removeAllHandlers(),b.onKeyDown.removeAllHandlers(),b.onKeyUp.removeAllHandlers()},this),this.initSimpleDomEvent("click",this.onClick),this.initSimpleDomEvent("dblclick",this.onDoubleClick),this.initSimpleDomEvent("mousedown",this.onMouseDown),this.initSimpleDomEvent("mouseup",this.onMouseUp),this.initSimpleDomEvent("mousemove",this.onMouseMove),this.initSimpleDomEvent("mouseover",this.onMouseEnter),this.initSimpleDomEvent("mouseout",this.onMouseLeave),this.initSimpleDomEvent("keypress",this.onKeyPress),this.initSimpleDomEvent("keydown",this.onKeyDown),this.initSimpleDomEvent("keyup",this.onKeyUp)},Element.prototype.initSimpleDomEvent=function(b,c){var d=this;this.domElement.addEventListener(b,function(b){var e=a.createEventArgs(d,b);c.invoke(e)})},Element.prototype.applyMarkup=function(b){for(var c in b){var d=b[c];if("string"==typeof d){var e=d.match(/^\{(.*)\}$/),f=d.match(/^\((.*)\)$/);e&&e[1]?this.bind(c,e[1]):f&&f[1]?this.express(c,f[1]):this[c]=d}else this[c]instanceof a.Event?this[c].addHandler(b[c],this):this[c]=d}},Element.prototype.defineProperty=function(b,c){var d,e=this;Object.defineProperty(this,b,{enumerable:!0,configurable:!0,get:function(){return c.getter?c.getter():d},set:function(f){if(c.acceptedValues&&c.acceptedValues.indexOf(f)<0)throw new Error(a.formatString('The value "{0}" is not accepted for a {1}. List of accepted values: {2}.',f,a.getClassName(e),c.acceptedValues.join(", ")));c.setter&&c.setter(f),d=f,c.observable&&e.onPropertyChanged.invoke(b)}})},Element.prototype.defineProperties=function(){var a=this;this.defineProperty("enabled",{setter:function(b){b?(a.domElement.classList.remove("disabled"),a.domElement.style.pointerEvents=""):(a.domElement.classList.add("disabled"),a.domElement.style.pointerEvents="none")},observable:!0}),this.defineProperty("name",{setter:function(b){return a.domElement.id=b},getter:function(){return a.domElement.id}}),this.defineProperty("key",{}),this.defineProperty("width",{setter:function(b){return a.domElement.style.width=b},getter:function(){return a.domElement.offsetWidth+"px"}}),this.defineProperty("height",{setter:function(b){return a.domElement.style.height=b},getter:function(){return a.domElement.offsetHeight+"px"}}),this.defineProperty("minWidth",{setter:function(b){return a.domElement.style.minWidth=b},getter:function(){return a.domElement.style.minWidth}}),this.defineProperty("minHeight",{setter:function(b){return a.domElement.style.minHeight=b},getter:function(){return a.domElement.style.minHeight}}),this.defineProperty("maxWidth",{setter:function(b){return a.domElement.style.maxWidth=b},getter:function(){return a.domElement.style.maxWidth}}),this.defineProperty("maxHeight",{setter:function(b){return a.domElement.style.maxHeight=b},getter:function(){return a.domElement.style.maxHeight}}),this.defineProperty("margin",{
setter:function(b){return a.domElement.style.margin=b},getter:function(){return a.domElement.style.margin}});var b="";this.defineProperty("style",{getter:function(){return b},setter:function(c){if(b){var d=b.split(" ");d.forEach(function(b){return a.domElement.classList.remove(b)})}b=c;var d=c.split(" ");d.forEach(function(b){return a.domElement.classList.add(b)})}}),this.defineProperty("flex",{setter:function(b){switch(a.domElement.classList.remove("flex-None"),a.domElement.classList.remove("flex-Stretch"),a.domElement.classList.remove("flex-Grow"),a.domElement.classList.remove("flex-Shrink"),b){case"none":a.domElement.classList.add("flex-None");break;case"stretch":a.domElement.classList.add("flex-Stretch");break;case"grow":a.domElement.classList.add("flex-Grow");break;case"shrink":a.domElement.classList.add("flex-Shrink");break;default:throw new Error('Unknown flex value "'+b+'".')}},acceptedValues:["none","shrink","grow","stretch"]}),this.defineProperty("visible",{setter:function(b){b?a.domElement.classList.remove("hidden"):a.domElement.classList.add("hidden")},observable:!0})},Element.prototype.setDefaults=function(){this.enabled=!0,this.visible=!0},Object.defineProperty(Element.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Element.prototype.__setParent__=function(a){if(a&&a.children.indexOf(this)<0)throw new Error('The "parent" property must be set only by parent.');this._parent&&this._parent.onScopeChanged.removeHandler(this.parentScopeChangeHandler),this._parent=a,a&&(this._parent.onScopeChanged.addHandler(this.parentScopeChangeHandler,this),this.parentScopeChangeHandler(),!this.__isRendered__&&a.__isRendered__&&this.__setRenderedState__(!0))},Element.prototype.remove=function(){this.detach(),this.bindings.pairs.forEach(function(a){return a.value.unbind()}),this.bindings.pairs.splice(0),this.expressions.pairs.forEach(function(a){return a.value.unbind()}),this.expressions.pairs.splice(0),a.Dom.remove(this.domElement),this.onRemoved.invoke(this),this.onRemoved.removeAllHandlers()},Element.prototype.insertBefore=function(a){if(!a.parent)throw new Error("Target element has no parent.");var b;if(this.parent===a.parent){var c=this.parent.children.indexOf(this),d=this.parent.children.indexOf(a);b=d>c?d-1:d}else b=a.parent.children.indexOf(a);a.parent.insert(this,b)},Element.prototype.insertAfter=function(a){if(!a.parent)throw new Error("Target element has no parent.");var b;if(this.parent===a.parent){var c=this.parent.children.indexOf(this),d=this.parent.children.indexOf(a);b=d>c?d:d+1}else b=a.parent.children.indexOf(a)+1;a.parent.insert(this,b)},Element.prototype.appendTo=function(a){a.append(this)},Element.prototype.prependTo=function(a){a.prepend(this)},Element.prototype.detach=function(){this.parent&&this.parent.detachChild(this)},Element.prototype.bubbleBy=function(a){for(var b=this;b;){if(!!a(b)==!0)return b;b=b.parent}return null},Element.prototype.focus=function(){this.domElement.focus()},Element.prototype.bind=function(b,c,d,e){var f=this.bindings.get(b);if(f&&f.unbind(),""===b||""===c)throw new Error("Binding path cannot be empty.");if("scope"===b&&!this.useParentScope&&!d)throw new Error("Unable to bind element's scope to itself.");d||(this.useParentScope?this.parent&&(d=this.parent.scope):d=this.scope),"string"==typeof b?this.bindings.set(b,new a.BindingManager(this,b,d,c,e)):this.bindings.set(b,new a.BindingCallManager(d,c,b,null,e))},Element.prototype.unbind=function(a){var b=this.bindings.get(a);b&&(b.unbind(),this.bindings.remove(a));var c=this.expressions.get(a);c&&(c.unbind(),this.expressions.remove(a))},Element.prototype.express=function(b,c,d){var e=this,f=this.expressions.get(b);f&&f.unbind(),f=new a.Expression(c,d||this.scope),this.expressions.set(b,f),"string"==typeof b?this.bindings.set(b,new a.BindingManager(this,b,f,"result")):this.bindings.set(b,new a.BindingCallManager(f,"result",function(a){return b(a,e)}))},Object.defineProperty(Element.prototype,"scope",{get:function(){return this._scope},set:function(b){var c=this;this.bindings.get("scope")&&b!==this.parent.scope&&(b=new a.Scope(b,this.parent.scope)),a.Log.write(1,96,'{0}:{1}: Set data scope "{2}".',a.getClassName(this),this.name||"-",b),this._scope=b,this.bindings.pairs.forEach(function(a){var d=a.key,e=a.value;"scope"===d||c.expressions.get(d)||e.resetWith(b)}),this.expressions.pairs.forEach(function(a){var c=a.key,d=a.value;"scope"!==c&&d.resetWith(b)}),this.onScopeChanged.invoke(b)},enumerable:!0,configurable:!0}),Element.prototype.onInput=function(b,c){a.Log.write(1,64,'{0}:{1}.{2}: Input "{3}".',a.getClassName(this),this.name||"-",b,c),"string"==typeof b?a.Path.setPropertyByPath(this,b,c):b(c);var d=this.bindings.get(b);d&&d.updateSource()},Element}(a.Model);a.Element=Element}(xp||(xp={}));var xp;!function(a){var Button=function(b){function Button(a){b.call(this,a)}return __extends(Button,b),Button.prototype.getTemplate=function(){var b=this;return a.Dom.create('\n                <button class="Button" type="button">\n                    <span class="wrapper">\n                        <span class="icon"></span>\n                        <span class="text"></span>\n                    </span>\n                </button>',{".icon":function(a){return b.iconElement=a},".text":function(a){return b.textElement=a}})},Button.prototype.setDefaults=function(){b.prototype.setDefaults.call(this),this.icon=null,this.text=""},Button.prototype.defineProperties=function(){var c=this;b.prototype.defineProperties.call(this);var d;this.defineProperty("icon",{setter:function(b){"string"==typeof b&&""!==b?(d&&("."===d[0]?c.iconElement.classList.remove(d.slice(1)):c.iconElement.style.backgroundImage=""),b=b.trim(),"*"!==b&&("."===b[0]?c.iconElement.classList.add(b.slice(1)):c.iconElement.style.backgroundImage=a.formatString("url({0})",b),d=b),c.iconElement.classList.remove("hidden")):c.iconElement.classList.add("hidden")}}),this.defineProperty("text",{setter:function(a){!!a==!0?(c.textElement.textContent=a,c.textElement.classList.remove("hidden")):c.textElement.classList.add("hidden")}})},Button}(a.Element);a.Button=Button}(xp||(xp={}));var xp;!function(a){var CheckBox=function(b){function CheckBox(a){b.call(this,a)}return __extends(CheckBox,b),CheckBox.prototype.getTemplate=function(){var b=this;return a.Dom.create('\n                <label class="CheckBox">\n                    <input type="checkbox"/>\n                    <span class="check"></span>\n                    <label class="text"></label>\n                </label>',{input:function(a){return b.checkElement=a},".text":function(a){return b.textElement=a}})},CheckBox.prototype.initEvents=function(){var c=this;b.prototype.initEvents.call(this),this.onCheckChange=new a.Event,this.onRemoved.addHandler(function(){return c.onCheckChange.removeAllHandlers()},this),this.domElement.addEventListener("change",function(b){if(!c.readonly){c.onInput("checked",c.checked);var d=a.createEventArgs(c,b);d.checked=c.checked,c.onCheckChange.invoke(d)}})},CheckBox.prototype.setDefaults=function(){b.prototype.setDefaults.call(this),this.checked=!1,this.readonly=!1,this.text=""},CheckBox.prototype.defineProperties=function(){var a=this;b.prototype.defineProperties.call(this),this.defineProperty("checked",{getter:function(){return a.checkElement.checked},setter:function(b){return a.checkElement.checked=b},observable:!0}),this.defineProperty("text",{setter:function(b){!!b==!0?(a.textElement.textContent=b,a.textElement.classList.remove("hidden")):a.textElement.classList.add("hidden")}}),this.defineProperty("readonly",{setter:function(b){b?(a.checkElement.readOnly=!0,a.domElement.style.pointerEvents="none"):(a.checkElement.readOnly=!1,a.domElement.style.pointerEvents="")}}),this.defineProperty("enabled",{setter:function(b){b?a.domElement.classList.remove("disabled"):a.domElement.classList.add("disabled"),!a.readonly&&b?(a.checkElement.readOnly=!1,a.domElement.style.pointerEvents=""):(a.checkElement.readOnly=!0,a.domElement.style.pointerEvents="none")},observable:!0})},CheckBox}(a.Element);a.CheckBox=CheckBox}(xp||(xp={}));var xp;!function(a){var Label=function(b){function Label(a){b.call(this,a)}return __extends(Label,b),Label.prototype.getTemplate=function(){return a.Dom.create('<label class="Label"></label>')},Label.prototype.defineProperties=function(){var a=this;b.prototype.defineProperties.call(this),this.defineProperty("text",{setter:function(b){a.domElement.textContent=b},observable:!0})},Label}(a.Element);a.Label=Label}(xp||(xp={}));var xp;!function(a){var Placeholder=function(b){function Placeholder(){b.apply(this,arguments)}return __extends(Placeholder,b),Placeholder.prototype.getTemplate=function(){return a.Dom.create('<span class="Placeholder">&nbsp;</span>')},Placeholder.prototype.setDefaults=function(){b.prototype.setDefaults.call(this)},Placeholder}(a.Element);a.Placeholder=Placeholder}(xp||(xp={}));var xp;!function(a){var RadioButton=function(b){function RadioButton(a){b.call(this,a)}return __extends(RadioButton,b),RadioButton.prototype.getTemplate=function(){var b=this;return a.Dom.create('\n                <label class="RadioButton">\n                    <input type="radio"/>\n                    <span class="check"></span>\n                    <label class="text"></label>\n                </label>',{input:function(a){return b.checkElement=a},".text":function(a){return b.textElement=a}})},RadioButton.prototype.initEvents=function(){var a=this;b.prototype.initEvents.call(this),this.onCheckChange.addHandler(function(b){b.checked&&a.onInput("selectedItem",a.item)},this)},RadioButton.prototype.defineProperties=function(){var a=this;b.prototype.defineProperties.call(this),this.defineProperty("group",{getter:function(){return a.checkElement.name},setter:function(b){return a.checkElement.name=b}}),this.defineProperty("item",{setter:function(b){a.checked!=(b==a.selectedItem)&&(a.checked=b==a.selectedItem)},observable:!0}),this.defineProperty("selectedItem",{setter:function(b){a.checked!=(b==a.item)&&(a.checked=b==a.item)},observable:!0})},RadioButton}(a.CheckBox);a.RadioButton=RadioButton}(xp||(xp={}));var xp;!function(a){var ToggleButton=function(b){function ToggleButton(a){b.call(this,a)}return __extends(ToggleButton,b),ToggleButton.prototype.getTemplate=function(){var b=this;return a.Dom.create('\n                <label class="ToggleButton">\n                    <input type="radio"/>\n                    <span class="icon"></span>\n                    <span class="text"></span>\n                </label>',{input:function(a){return b.checkElement=a},".icon":function(a){return b.iconElement=a},".text":function(a){return b.textElement=a}})},ToggleButton.prototype.setDefaults=function(){b.prototype.setDefaults.call(this),this.icon=null},ToggleButton.prototype.defineProperties=function(){var c=this;b.prototype.defineProperties.call(this),this.defineProperty("checked",{getter:function(){return c.checkElement.checked},setter:function(a){c.checkElement.checked=a,a?c.domElement.classList.add("checked"):c.domElement.classList.remove("checked")},observable:!0});var d;this.defineProperty("icon",{setter:function(b){"string"==typeof b&&""!==b?(d&&("."===d[0]?c.iconElement.classList.remove(d.slice(1)):c.iconElement.style.backgroundImage=""),b=b.trim(),"*"!==b&&("."===b[0]?c.iconElement.classList.add(b.slice(1)):c.iconElement.style.backgroundImage=a.formatString("url({0})",b),d=b),c.iconElement.classList.remove("hidden")):c.iconElement.classList.add("hidden")}})},ToggleButton}(a.RadioButton);a.ToggleButton=ToggleButton}(xp||(xp={}));var xp;!function(a){var TextBox=function(b){function TextBox(a){b.call(this,a)}return __extends(TextBox,b),TextBox.prototype.getTemplate=function(){var b=a.Dom.create('<input class="TextBox" type="text" />');return b},TextBox.prototype.initEvents=function(){var c=this;b.prototype.initEvents.call(this),this.onTextChange=new a.Event,this.onRemoved.addHandler(function(){return c.onTextChange.removeAllHandlers()},this);var d="",e=function(b){var e=a.createEventArgs(c,b);e.oldText=d;var f=c.value.toString();e.newText=f,c.onTextChange.invoke(e),c.onInput("text",c.value),c.onInput("value",c.value),d=f};this.domElement.addEventListener("change",function(a){e(a)}),this.domElement.addEventListener("input",function(a){c.notifyOnKeyDown&&e(a)});var f=!!navigator.userAgent.match(/Trident\/7\./);this.domElement.addEventListener("keypress",function(a){13===a.keyCode&&f&&e(a)})},TextBox.prototype.setDefaults=function(){b.prototype.setDefaults.call(this),this.type="string",this.readonly=!1,this.placeholder=""},TextBox.prototype.defineProperties=function(){var a=this;b.prototype.defineProperties.call(this),this.defineProperty("text",{getter:function(){return a.domElement.value},setter:function(b){(void 0===b||null===b)&&(b=""),a.domElement.value=b},observable:!0}),this.defineProperty("value",{getter:function(){switch(a.type){case"string":return a.text;case"number":return parseFloat(a.text)||0;default:throw new Error("TextBox type value is not implemented.")}},setter:function(b){var c=typeof b;("number"===c||"boolean"===c)&&(b=b.toString()),(void 0===b||null===b)&&(b=""),a.text=b},observable:!0}),this.defineProperty("type",{setter:function(b){switch(b){case"string":a.domElement.type="text";break;case"number":a.domElement.type="number";break;default:throw new Error("TextBoxType value is not implemented.")}},acceptedValues:["string","number"]}),this.defineProperty("min",{setter:function(b){return a.domElement.setAttribute("min",b.toString())}}),this.defineProperty("max",{setter:function(b){return a.domElement.setAttribute("max",b.toString())}}),this.defineProperty("step",{setter:function(b){return a.domElement.setAttribute("step",b.toString())}}),this.defineProperty("readonly",{setter:function(b){b?a.domElement.readOnly=!0:a.domElement.readOnly=!1}}),this.defineProperty("placeholder",{getter:function(){return a.domElement.placeholder},setter:function(b){b?a.domElement.placeholder=b:a.domElement.placeholder=""}})},TextBox}(a.Element);a.TextBox=TextBox}(xp||(xp={}));var xp;!function(a){var TextArea=function(b){function TextArea(){b.apply(this,arguments)}return __extends(TextArea,b),TextArea.prototype.getTemplate=function(){var b=a.Dom.create('<textarea class="TextArea TextBox" spellcheck="false"></textarea>');return b},TextArea}(a.TextBox);a.TextArea=TextArea}(xp||(xp={}));var xp;!function(a){var Html=function(b){function Html(a){b.call(this,a)}return __extends(Html,b),Html.prototype.getTemplate=function(){return document.createElement("div")},Html.prototype.applyMarkup=function(a){var c={};for(var d in a)c[d]=a[d];if(c.html&&c.url||!c.html&&!c.url)throw new Error('One property, "html" or "url", must be specified.');c.html&&(this.html=c.html,delete c.html),c.url&&(this.url=c.url,delete c.url),b.prototype.applyMarkup.call(this,c)},Html.prototype.defineProperties=function(){var c=this;b.prototype.defineProperties.call(this);var d=!1,e=!1,f=!1;this.defineProperty("html",{getter:function(){return c.domElement.outerHTML},setter:function(b){if(!f&&e)throw new Error("Unable to set HTML twice.");var d=a.Dom.create(b);if(1!==d.nodeType)throw new Error("Html control must have one root element.");c.domElement.parentNode&&c.domElement.parentNode.replaceChild(d,c.domElement),c.domElement=d,e=!0,c.initEvents()}}),this.defineProperty("url",{setter:function(a){if(d)throw new Error("Unable to set URL twice.");var b=new XMLHttpRequest;b.open("get",a),b.onreadystatechange=function(){4===b.readyState&&(d=!0,f=!0,c.html=b.responseText,f=!1)},b.send(null)}})},Html}(a.Element);a.Html=Html}(xp||(xp={}));var xp;!function(a){var Container=function(b){function Container(c,d){var e=this;b.call(this,c),d&&d.forEach(function(a){return e.append(a)}),this.cascadeBy(function(b){if(b!==e&&b.name){if(b.name in e)throw new Error(a.formatString('Unable to set named child "{0}". Container\'s property is already defined.',b.name));e[b.name]=b}})}return __extends(Container,b),Container.prototype.initElement=function(){this.children=[],b.prototype.initElement.call(this)},Container.prototype.getContainerElement=function(){return this.domElement},Container.prototype.__setRenderedState__=function(a){this.__isRendered__=a,this.children&&this.children.forEach(function(b){b.__setRenderedState__(a)}),a&&this.onRendered&&this.onRendered.invoke(this)},Container.prototype.defineProperties=function(){var a=this;b.prototype.defineProperties.call(this),this.defineProperty("padding",{setter:function(b){return a.domElement.style.padding=b},getter:function(){return a.domElement.style.padding}})},Container.prototype.append=function(a){this.insert(a,this.children.length)},Container.prototype.prepend=function(a){this.insert(a,0)},Container.prototype.insert=function(a,b){if(a.parent!==this||this.children.indexOf(a)!=b){if(b>this.children.length)throw new Error("Index was out or range.");var c=this.getContainerElement();if(a.parent===this){var d=this.children.indexOf(a),e=b>d?b+1:b;e===this.children.length?c.appendChild(a.domElement):c.insertBefore(a.domElement,c.children.item(e)),this.children.move(d,b)}else a.parent&&a.parent.detachChild(a),b===this.children.length?c.appendChild(a.domElement):c.insertBefore(a.domElement,c.children.item(b)),this.children.splice(b,0,a),a.__setParent__(this)}},Container.prototype.detachChild=function(b){var c=this.children.indexOf(b);if(0>c)throw new Error("Element is not a child of this container.");this.children.splice(c,1),b.__setParent__(null),a.Dom.remove(b.domElement)},Container.prototype.cascadeBy=function(a,b){if(void 0===b&&(b=!1),b&&!!a(this)==!0)return this;for(var c=0;c<this.children.length;c++){if(!!a(this.children[c])==!0)return this.children[c];if(this.children[c]instanceof Container){var d=this.children[c].cascadeBy(a,!1);if(null!=d)return d}}return null},Container.prototype.find=function(a){return this.cascadeBy(function(b){return a(b)})},Container.prototype.findAll=function(a){var b=[];return this.cascadeBy(function(c){a(c)&&b.push(c)}),b},Container.prototype.remove=function(){this.removeChildren(),b.prototype.remove.call(this)},Container.prototype.removeChildren=function(){for(var a=this.children.length-1;a>=0;a--)this.children[a].remove();this.children=[]},Container}(a.Element);a.Container=Container}(xp||(xp={}));var xp;!function(a){var Stack=function(a){function Stack(){a.apply(this,arguments)}return __extends(Stack,a),Stack.prototype.setDefaults=function(){a.prototype.setDefaults.call(this),this.itemsIndent="none",this.scrollBar="both",this.wrapping="nowrap"},Stack.prototype.defineProperties=function(){var b=this;a.prototype.defineProperties.call(this),this.defineProperty("itemsIndent",{setter:function(a){switch(b.domElement.classList.remove("itemsIndent-05"),b.domElement.classList.remove("itemsIndent-1"),b.domElement.classList.remove("itemsIndent-2"),b.domElement.classList.remove("itemsIndent-4"),a){case"none":break;case"0.5em":b.domElement.classList.add("itemsIndent-05");break;case"1em":b.domElement.classList.add("itemsIndent-1");break;case"2em":b.domElement.classList.add("itemsIndent-2");break;case"4em":b.domElement.classList.add("itemsIndent-4");break;default:throw new Error("Unknown items indent value: "+a)}},acceptedValues:["none","0.5em","1em","2em","4em"]}),this.defineProperty("scrollBar",{setter:function(a){switch(b.domElement.classList.remove("scrollBar-None"),b.domElement.classList.remove("scrollBar-Horizontal"),b.domElement.classList.remove("scrollBar-Vertical"),b.domElement.classList.remove("scrollBar-Both"),a){case"none":b.domElement.classList.add("scrollBar-None");break;case"horizontal":b.domElement.classList.add("scrollBar-Horizontal");break;case"vertical":b.domElement.classList.add("scrollBar-Vertical");break;case"both":b.domElement.classList.add("scrollBar-Both");break;default:throw new Error("Unknown scroll bar value: "+a)}},acceptedValues:["none","horizontal","vertical","both"]}),this.defineProperty("wrapping",{setter:function(a){switch(b.domElement.classList.remove("wrapping-NoWrap"),b.domElement.classList.remove("wrapping-Wrap"),a){case"nowrap":b.domElement.classList.add("wrapping-NoWrap");break;case"wrap":b.domElement.classList.add("wrapping-Wrap");break;default:throw new Error("Unknown wrapping value: "+a)}},acceptedValues:["nowrap","wrap"]})},Stack}(a.Container);a.Stack=Stack}(xp||(xp={}));var xp;!function(a){var HBox=function(b){function HBox(a,c){b.call(this,a,c)}return __extends(HBox,b),HBox.prototype.getTemplate=function(){var b=a.Dom.create('<div class="HBox"></div>');return b},HBox.prototype.setDefaults=function(){b.prototype.setDefaults.call(this),this.contentAlign="left",this.itemsAlign="stretch"},HBox.prototype.defineProperties=function(){var a=this;b.prototype.defineProperties.call(this),this.defineProperty("contentAlign",{setter:function(b){switch(a.domElement.classList.remove("contentAlign-Left"),a.domElement.classList.remove("contentAlign-Center"),a.domElement.classList.remove("contentAlign-Right"),b){case"left":a.domElement.classList.add("contentAlign-Left");break;case"center":a.domElement.classList.add("contentAlign-Center");break;case"right":a.domElement.classList.add("contentAlign-Right");break;default:throw new Error("Unknown content alignment value: "+b)}},acceptedValues:["left","center","right"]}),this.defineProperty("itemsAlign",{setter:function(b){switch(a.domElement.classList.remove("itemsAlign-Top"),a.domElement.classList.remove("itemsAlign-Middle"),a.domElement.classList.remove("itemsAlign-Bottom"),a.domElement.classList.remove("itemsAlign-Stretch"),b){case"top":a.domElement.classList.add("itemsAlign-Top");break;case"middle":a.domElement.classList.add("itemsAlign-Middle");break;case"bottom":a.domElement.classList.add("itemsAlign-Bottom");break;case"stretch":a.domElement.classList.add("itemsAlign-Stretch");break;default:throw new Error("Unknown items alignment value: "+b)}},acceptedValues:["top","middle","bottom","stretch"]})},HBox}(a.Stack);a.HBox=HBox}(xp||(xp={}));var xp;!function(a){var VBox=function(b){function VBox(a,c){b.call(this,a,c)}return __extends(VBox,b),VBox.prototype.getTemplate=function(){var b=a.Dom.create('<div class="VBox"></div>');return b},VBox.prototype.setDefaults=function(){b.prototype.setDefaults.call(this),this.contentAlign="top",this.itemsAlign="stretch"},VBox.prototype.defineProperties=function(){var a=this;b.prototype.defineProperties.call(this),this.defineProperty("contentAlign",{setter:function(b){switch(a.domElement.classList.remove("contentAlign-Top"),a.domElement.classList.remove("contentAlign-Middle"),a.domElement.classList.remove("contentAlign-Bottom"),b){case"top":a.domElement.classList.add("contentAlign-Top");break;case"middle":a.domElement.classList.add("contentAlign-Middle");break;case"bottom":a.domElement.classList.add("contentAlign-Bottom");break;default:throw new Error("Unknown content alignment value: "+b)}},acceptedValues:["top","middle","bottom"]}),this.defineProperty("itemsAlign",{setter:function(b){switch(a.domElement.classList.remove("itemsAlign-Left"),a.domElement.classList.remove("itemsAlign-Center"),a.domElement.classList.remove("itemsAlign-Right"),a.domElement.classList.remove("itemsAlign-Stretch"),b){case"left":a.domElement.classList.add("itemsAlign-Left");break;case"center":a.domElement.classList.add("itemsAlign-Center");break;case"right":a.domElement.classList.add("itemsAlign-Right");break;case"stretch":a.domElement.classList.add("itemsAlign-Stretch");break;default:throw new Error("Unknown items alignment value: "+b)}},acceptedValues:["left","center","right","stretch"]})},VBox}(a.Stack);a.VBox=VBox}(xp||(xp={}));var xp;!function(a){var List=function(b){function List(a){b.call(this,a),this.itemReplacementToken=!1,this.itemReplacementHandlers=[]}return __extends(List,b),List.prototype.getTemplate=function(){return a.Dom.create('<div class="List VBox"></div>')},List.prototype.setDefaults=function(){b.prototype.setDefaults.call(this),this.itemId="item"},List.prototype.defineProperties=function(){var c=this;b.prototype.defineProperties.call(this),this.defineProperty("items",{setter:function(b){if(c.removeReplacementHandlers(),c.removeChildren(),c.itemsRegistar.unsubscribeAll(),b&&c.itemCreator){if(b.forEach(function(a,b){c.addItem(b,a)}),a.isCollectionNotifier(b)){var d=b;c.itemsRegistar.subscribe(d.onCollectionChanged,function(a){switch(a.action){case 4:case 0:c.addItem(a.newIndex,a.newItem);break;case 5:case 2:var b=c.itemReplacementHandlers.filter(function(b){return b.item===a.oldItem})[0];b.holder.onPropertyChanged.removeHandler(b.handler),c.itemReplacementHandlers.splice(c.itemReplacementHandlers.indexOf(b),1),c.children[a.oldIndex].remove();break;case 1:c.itemReplacementToken||(c.children[a.newIndex].scope[c.itemId]=a.newItem);break;case 3:c.insert(c.children[a.oldIndex],a.newIndex);break;default:throw new Error("Not implemented.")}},c)}if(a.isNotifier(b)){var e=function(a){};c.itemsRegistar.subscribe(b.onPropertyChanged,e,c),e("length")}}}}),this.defineProperty("itemCreator",{setter:function(){return c.items=c.items}})},List.prototype.initEvents=function(){b.prototype.initEvents.call(this),this.itemsRegistar=new a.EventRegistrar},List.prototype.addItem=function(b,c){var d=this.itemCreator(c);d.name=a.createUuid(),d.useParentScope=!1,this.insert(d,b),d.scope=this.createItemScopeFrom(c)},List.prototype.createItemScopeFrom=function(b){var c=this,d={};d[this.itemId]=b;var e=new a.Scope(a.observable(d),this.scope),f={item:b,handler:function(a){if(a===c.itemId){var b=c.items.indexOf(f.item);if(0>b)throw new Error("Item does not belong to List items.");c.itemReplacementToken=!0,c.items[b]=f.holder[a],c.itemReplacementToken=!1,f.item=f.holder[a]}},holder:e};return f.holder.onPropertyChanged.addHandler(f.handler,this),this.itemReplacementHandlers.push(f),e},List.prototype.remove=function(){this.removeReplacementHandlers(),b.prototype.remove.call(this)},List.prototype.removeReplacementHandlers=function(){this.itemReplacementHandlers&&(this.itemReplacementHandlers.forEach(function(a){a.holder.onPropertyChanged.removeHandler(a.handler)}),this.itemReplacementHandlers=[])},List}(a.VBox);a.List=List}(xp||(xp={}));var xp;!function(a){var Window=function(b){function Window(a,c){b.call(this,a,c)}return __extends(Window,b),Window.prototype.getTemplate=function(){var a=document.body;return a.classList.add("Window"),a.classList.add("VBox"),this.__setRenderedState__(!0),a},Window.prototype.initElement=function(){if(b.prototype.initElement.call(this),Window.instance)throw new Error("There is already another Window.");Window.instance=this},Window.prototype.setDefaults=function(){b.prototype.setDefaults.call(this),this.title="XP Application"},Window.prototype.defineProperties=function(){b.prototype.defineProperties.call(this),this.defineProperty("title",{getter:function(){return document.title},setter:function(a){return document.title=a},observable:!0})},Window.prototype.showModal=function(b){if(this.tint||this.modal)throw new Error("Another modal is displayed.");this.tint=new a.ModalTint,this.tint.appendTo(this),this.modal=b,b.appendTo(this.tint)},Window.prototype.closeModal=function(){this.modal.remove(),this.tint.remove(),this.modal=null,this.tint=null},Window}(a.VBox);a.Window=Window}(xp||(xp={}));var xp;!function(a){var Modal=function(b){function Modal(a,c){b.call(this,a,c)}return __extends(Modal,b),Modal.prototype.show=function(){a.Window.instance.showModal(this)},Modal.prototype.close=function(){var b=this.onClose?this.onClose():!0;b&&a.Window.instance.closeModal()},Modal.prototype.getTemplate=function(){return a.Dom.create('<div class="Modal VBox"></div>')},Modal}(a.VBox);a.Modal=Modal;var ModalTint=function(b){function ModalTint(){b.apply(this,arguments)}return __extends(ModalTint,b),ModalTint.prototype.getTemplate=function(){return a.Dom.create('<div class="ModalTint"></div>')},ModalTint}(a.Container);a.ModalTint=ModalTint}(xp||(xp={}));var xp;!function(a){var MessageBox=function(b){function MessageBox(c,d,e){var f=this;if(b.call(this,{padding:"1em 1.5em",width:"32em",margin:"-15% 0 0 0"}),void 0!==d){var g=new a.Label({text:d,style:"title",margin:"0 0 1rem 0"});g.appendTo(this)}if(void 0!==c){var h=new a.Label({margin:"0 0 2em 0",text:c,style:"message"});h.appendTo(this)}e=e||{OK:function(){}};var i=new a.HBox({contentAlign:"right"});for(var j in e)!function(b){var c=new a.Button({text:b,minWidth:"4em",init:function(a){return a.onClick.addHandler(function(){e[b](),f.close()})}});c.appendTo(i)}(j);i.appendTo(this)}return __extends(MessageBox,b),MessageBox.show=function(a,b,c){var d=new MessageBox(a,b,c);d.show()},MessageBox}(a.Modal);a.MessageBox=MessageBox}(xp||(xp={}));var xp;!function(a){var ContextMenu=function(c){function ContextMenu(a){var b=this;c.call(this),a.forEach(function(a){return b.createMenuItem(a)})}return __extends(ContextMenu,c),ContextMenu.prototype.getTemplate=function(){return a.Dom.create('<div class="ContextMenu VBox"></div>')},ContextMenu.prototype.createMenuItem=function(a){var c=new b(a,this);c.appendTo(this)},ContextMenu.prototype.show=function(b,c){var d=this,e=function(a){d.remove(),window.removeEventListener("mousedown",e),window.removeEventListener("keydown",f)},f=function(a){27===a.keyCode&&e(a)};window.addEventListener("mousedown",e),window.addEventListener("keydown",f),this.domElement.style.left=b+"px",this.domElement.style.top=c+"px",a.Window.instance.append(this);var g=this.domElement.getBoundingClientRect(),h=document.documentElement.getBoundingClientRect();g.right>h.right&&(this.domElement.style.left=b-g.width+"px"),g.bottom>h.bottom&&(this.domElement.style.top=c-g.height+"px")},ContextMenu.show=function(a,b,c){var d=new ContextMenu(c);d.show(a,b)},ContextMenu}(a.VBox);a.ContextMenu=ContextMenu;var b=function(b){function c(a,c){b.call(this),this.menu=c,this.initItemData(a)}return __extends(c,b),c.prototype.initItemData=function(b){var c=this;b.icon&&("."===b.icon[0]?this.iconElement.classList.add(b.icon.slice(1)):this.iconElement.style.backgroundImage=a.formatString("url({0})",b.icon)),b.key&&(this.keyElement.textContent=b.key),b.disabled&&(this.enabled=!1),this.textElement.textContent=b.text,this.onMouseDown.addHandler(function(a){a.domEvent.stopPropagation(),c.menu.remove(),b.action()},this)},c.prototype.getTemplate=function(){var b=a.Dom.create('\n                <span class="ContextMenuItem" role="button">\n                    <span class="wrapper">\n                        <span class="icon"></span>\n                        <span class="text"></span>\n                        <span class="key"></span>\n                    </span>\n                </button>');return this.iconElement=a.Dom.select(".icon",b),this.textElement=a.Dom.select(".text",b),this.keyElement=a.Dom.select(".key",b),b},c}(a.Element)}(xp||(xp={}));var xp;!function(a){var b;!function(b){function c(b){var c=typeof b;if("boolean"!==c)throw new Error("Assert statement must be boolean but not "+c+".");if(b!==!0)throw new Error(a.formatString("Statement is wrong."))}function d(b,c){if(b!==c)throw new Error(a.formatString('"{0}" is not equal to "{1}".',b,c))}b.assert=c,b.assertEqual=d}(b=a.Tests||(a.Tests={}))}(xp||(xp={}));